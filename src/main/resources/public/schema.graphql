directive @auth(role : String!) on FIELD_DEFINITION

scalar Date
scalar LocalDate
scalar LocalDateTime
scalar LocalTime

schema {
    query: Query
    mutation: Mutation
}


#
# Queries
#
type Query {
    profile: Profile
    playgrounds: [Playground]
    progress: Progress
    playground(id: String!): Playground
    validation(id: String!): PlaygroundObservations
    totalVolunteers: Long
}

type Profile {
    id : String!
    username : String!
}

type Playground {
    id : String!
    name : String
    lng : Float
    lat : Float
    status: Status
    smokeFreeDate: LocalDate
    volunteerCount: Int #@auth(role : "manager")
    votes: Int
    managers: [Manager!]
    playgroundObservations: PlaygroundObservations!
    volunteers: [Volunteer!]
}

enum Status {
    not_started
    in_progress
    finished
}

type Progress {
    total: Int
    remaining: Int
    smokeFree: Stat
    workingOnIt: Stat
    smoking: Stat
}

type Manager {
    id : String!
    username : String!
}

type Volunteer {
    userId: String!
    userName: String!
}

type Stat {
    count : Int
    percentage : Int
}

type PlaygroundObservations {
    smokefreeObservationsCount: Int!
    smokeObservationCount: Int!
    smokefreeConsecutiveStreak: Int!
    volunteersObservations: [Observation!]

}

type Observation {
    citizenId: String!
    userName: String!
    isSmokeFree: Boolean!
    observationDate: LocalDate!
    recordedObservation: String!
}

#
# Mutations
#

type Mutation {
    createInitiative(input: CreateInitiativeInput!): Playground!
    joinInitiative(input: JoinInitiativeInput!): Playground!

    claimManagerRole(input: ClaimManagerRoleCommand!): Playground!

    decideToBecomeSmokeFree(input: DecideToBecomeSmokeFreeCommand!): InputAcceptedResponse!
    decideToNotBecomeSmokeFree(input: DecideToNotBecomeSmokeFreeCommand!): InputAcceptedResponse!

    commitToSmokeFreeDate(input: CommitToSmokeFreeDateCommand!): InputAcceptedResponse!

    recordSmokeFreePlaygroundObservation(input: RecordSmokeFreePlaygroundObservationCommand!): Playground!
}
type InputAcceptedResponse {
    id : String!
}
enum Status {
    not_started
    in_progress
    finished
}
enum Type {
    smokefree
}

input CreateInitiativeInput {
    initiativeId: String!
    type: Type!
    status: Status!
    name: String!
    lat: Float!
    lng: Float!
}
input JoinInitiativeInput {
    initiativeId: String!
}
input DecideToBecomeSmokeFreeCommand {
    initiativeId: String!
}
input DecideToNotBecomeSmokeFreeCommand {
    initiativeId: String!
    reason: String
}
input ClaimManagerRoleCommand {
    initiativeId: String!
}
input CommitToSmokeFreeDateCommand {
    initiativeId: String!
    smokeFreeDate: LocalDate!
}
input RecordSmokeFreePlaygroundObservationCommand {
    initiativeId: String!
    citizenId: String!
    isSmokeFree: Boolean!
    recordObservation: String!
}
